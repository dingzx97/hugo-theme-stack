{{- $src := .Get "src" | default (.Get 0) -}}
{{- $secret := .Get "secret" | default (.Get 1) -}}

{{- $video := or (.Page.Resources.GetMatch $src) (resources.GetMatch $src) -}}
{{ if and $video (or hugo.IsDevelopment (not $secret)) }}
    {{ $src = $video.RelPermalink }}
{{ end }}

<div class="video-wrapper">
    <video
    controls
    src="{{- $src -}}"
    {{ with .Get "poster" }}poster="{{- . -}}"{{ end }}
    {{ with .Get "autoplay" }}autoplay{{ end }}
    >
        <p>
            Your browser doesn't support HTML5 video. Here is a
            <a href="{{- $src -}}">link to the video</a> instead.
        </p>
    </video>
</div>